!function(e,t,i,s){var o=function(n,l){this.defaults={title:"标题",showTitle:!0,closeText:"",btnConfirm:"确定",btnCancel:"取消",showBtns:!0,showBtnConfirm:!0,showBtnCancel:!0,draggable:!0,modal:!0,center:!0,fixed:!0,time:0,id:!1};var a=e.extend({},this.defaults,l);a.id=a.id?a.id:"knDialog-"+o.__count;var c=a.id+"-overlay",r=null,d=!1,f=!1,u=!1,h=a.showTitle?'<div class="bar"><span class="title">'+a.title+'</span><span class="close">'+a.closeText+"</span></div>":"",m=a.showBtnConfirm?'<div class="btn confirm">'+a.btnConfirm+"</div>":"",v=a.showBtnCancel?'<div class="btn cancel disabled">'+a.btnCancel+"</div>":"",p=a.showBtns?'<div class="btns">'+m+v+"</div>":"",b=e('<div id="'+a.id+'" class="dialog">'+h+'<div class="container"><div class="content"></div>'+p+"</div></div>").hide();e("body").append(b),this.resetDia=function(){if(a.center){var s=(e(t).width()-b.width())/2,o=(e(t).height()-b.height())/2;b.css(!u&&a.fixed?{top:o,left:s}:{top:o+e(i).scrollTop(),left:s+e(i).scrollLeft()})}};var w=function(){function s(e){var i=t.event||e,s=parseInt(b.css("top"))+(i.clientY-d.y),o=parseInt(b.css("left"))+(i.clientX-d.x);b.css({top:s,left:o}),d.x=i.clientX,d.y=i.clientY}if(a.modal&&(e("body").append('<div id="'+c+'" class="dialog-layerMask"></div>'),e("#"+c).css({left:0,top:0,width:"100%",height:e(i).height(),"z-index":++o.__zindex,position:"absolute"})),b.css({"z-index":++o.__zindex,position:a.fixed?"fixed":"absolute"}),u&&a.fixed){b.css("position","absolute"),this.resetDia();var n=parseInt(b.css("top"))-e(i).scrollTop(),l=parseInt(b.css("left"))-e(i).scrollLeft();e(t).scroll(function(){b.css({top:e(i).scrollTop()+n,left:e(i).scrollLeft()+l})})}var d={x:0,y:0},f=a;b.find(".bar").on("mousedown",function(){if(f.draggable){var o=t.event||o;d.x=o.clientX,d.y=o.clientY,b.css("cursor","move"),e(i).bind("mousemove",s)}}),e(i).mouseup(function(){e(i).unbind("mousemove",s),b.css("cursor","default")}),b.find(".close").bind("click",this.close),b.find(".cancel").bind("click",this.close),b.bind("mousedown",function(){e(this).css("z-index",++o.__zindex)}),0!==a.time&&(r=setTimeout(this.close,a.time))};this.setConent=function(t){var i=b.find(".content");if("object"==typeof t)switch(t.type.toLowerCase()){case"id":i.html(e("#"+t.value).html());break;case"img":i.html("加载中..."),e('<img alt="" />').load(function(){i.empty().append(e(this)),this.resetDia()}).attr("src",t.value);break;case"url":i.html("加载中..."),e.ajax({url:t.value,success:function(e){i.html(e),this.resetDia()},error:function(){i.html("出错啦！")}});break;case"iframe":i.append(e('<iframe src="'+t.value+'" />'));break;case"text":i.html(t.value);break;default:i.html(t.value)}else i.html(t)},this.show=function(){s!==a.beforeShow&&a.beforeShow&&a.beforeShow();var t=function(t){if(!f)return e("#"+t).css("opacity");var o=i.getElementById(t);return s!==o&&s!==o.filters&&s!==o.filters.alpha&&s!==o.filters.alpha.opacity?o.filters.alpha.opacity/100:1};a.modal&&e("#"+c).fadeTo("slow",t(c)),b.fadeTo("slow",t(a.id),function(){s!==a.afterShow&&a.afterShow(),d=!0}),0!==a.time&&(r=setTimeout(this.close,a.time)),this.resetDia()},this.hide=function(){d&&(s!==a.beforeHide&&a.beforeHide&&a.beforeHide(),b.fadeOut("slow",function(){s!==a.afterHide&&a.afterHide()}),a.modal&&e("#"+c).fadeOut("slow"),d=!1)},this.close=function(){s!==a.beforeClose&&a.beforeClose&&a.beforeClose(),b.fadeOut("slow",function(){e(this).remove(),d=!1,s!==a.afterClose&&a.afterClose()}),a.modal&&e("#"+c).fadeOut("slow",function(){e(this).remove()}),clearTimeout(r)},w.call(this),this.setConent(n),o.__count++,o.__zindex++};o.__zindex=999,o.__count=1,o.prototype={test:function(){return console.dir(options)}},e.fn.knDialog=function(e,t){var i=new o(e,t);return i}}(jQuery,window,document);